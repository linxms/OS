# 2023秋《操作系统》课程实验报告
    实验1    21301156  林家旺
## 一、实验步骤 
[说明文字：提交时请删除该说明。实验步骤应包含每一个步骤简短及结果截图。]
1. 创建一个Rust项目
首先进入已配置的好环境的容器，并进入/mnt目录。
执行如下命令查看应用运行结果。
![Alt text](image/1.png)
2. 移除标准库依赖

（1） 首先，需要修改target为riscv64
在os/.cargo目录下创建config文件，并增加如下内容：
```rust
# os/.cargo/config
[build]
target = "riscv64gc-unknown-none-elf"
```
---
（2）修改main.rs文件
 在 main.rs 的开头分别加入如下内容：

main.rs 的位置，可以先进行回到os目录
```
cd /os
```
然后使用语句
```ls```
会出现src目录，这就是main.rs的位置

此处命令行语句可以使用:
```
cd src
vim main.rs
```
就可以往里面写东西了

```rust
#![no_std]
#![no_main]
```
![Alt text](image/2.png)

同时，因为标准库 std 中提供了 panic 的处理函数 #[panic_handler]，所以还需要实现panic handler。
具体增加如下内容：
```rust
use core::panic::PanicInfo;

#[panic_handler]
fn panic(_info: &PanicInfo) -> ! {
    loop {}
}
```
注意还需要删除main函数。
![Alt text](image/3.png)

---
修改完后执行cargo build进行编译。如若出现编译错误，请尝试执行如下命令安装相关软件包。
```
rustup target add riscv64gc-unknown-none-elf
cargo install cargo-binutils
rustup component add llvm-tools-preview
rustup component add rust-src
```

---
修改完成的可以编译通过的代码如下：
```rust
#![no_std]
#![no_main]

use core::panic::PanicInfo;

#[panic_handler]
fn panic(_info: &PanicInfo) -> ! {
    loop {}
}
```

修改完成代码后，请提交git，并注意在commit的注释中加入自己的学号。
同时，建议在自己本机提交，而不是在docker镜像中提交。

（3）分析独立的可执行程序
执行如下命令分析移除标准库后的独立可执行程序。
file target/riscv64gc-unknown-none-elf/debug/os
rust-readobj -h target/riscv64gc-unknown-none-elf/debug/os
rust-objdump -S target/riscv64gc-unknown-none-elf/debug/os

通过分析可以发现编译生成的二进制程序是一个空程序，这是因为编译器找不到入口函数，所以没有生成后续的代码。

请注意通过截图记录分析的结果，并将结果放进实验报告，截图请截取整个命令行窗口。
二、思考问题
[说明文字：提交时请删除该说明。请仔细回答每个实验中的思考问题。]
（1）思考问题1
这是思考问题的答案。
（2）思考问题2
这是思考问题的答案。
三、Git提交截图
[说明文字：提交时请删除该说明。请截取github或者gitee中当次实验全部提交记录的截图。为了区别开不同的实验，建议每个实验创建一个git分支。]
四、其他说明
[说明文字：提交时请删除该说明。自己想补充的其他说明。]
